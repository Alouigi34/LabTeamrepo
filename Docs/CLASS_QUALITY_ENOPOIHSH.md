
Integration Team

Η ομάδα μας είχε αναλάβει την ενοποίηση (integration) της κατασκευής μας. Δηλαδή, πήραμε τη δουλειά των υπόλοιπων ομάδων και την ενώσαμε δημιουργώντας την τελική κατασκευή που θα παρουσιάσουμε στον διαγωνισμό. Η δουλειά μας χωρίζεται σε δύο μέρη:

1.	Ενοποίηση των προγραμμάτων: Αφού οι υπόλοιπες ομάδες, που είχαν αναλάβει από έναν αισθητήρα η κάθε μία, τελείωσαν τη δουλειά τους και έκαναν κάθε αισθητήρα να δουλεύει αυτόνομα έδωσαν στην ομάδα μας τα προγράμματά τους και τα κυκλώματά τους. Εμείς τα πήραμε και τα ενώσαμε δημιουργώντας ένα μεγαλύτερο πρόγραμμα με διάφορα tabs, τα οποία περιέχουν τα προγράμματα των αισθητήρων χωριστά. Προσθέσαμε μερικά ακόμα tabs, ένα για την lcd, στην οποία θα φαίνονται τα αποτελέσματα των μετρήσεών μας, ένα κεντρικό tab, στο οποίο καλούνται τα προγράμματα των υπόλοιπων tab και γίνονται οι υπολογισμοί, και ένα tab με global defines και μεταβλητές ώστε να έχουμε συγκεντρωμένες όλες τις παραμέτρους κάπου μαζί. Στη συνέχεια, αρχίσαμε να γράφουμε το τελικό πρόγραμμα, που θα έκανε και όλους τους υπολογισμούς για να βρούμε πια τάξη τελικά είναι η καλύτερη.

2.	Ενοποίηση της κατασκευής: Μόλις οι υπόλοιπες ομάδες τελείωσαν το hardware κομμάτι της δουλειάς τους, μας έδωσαν τη συνδεσμολογία τους για τους αισθητήρες (αρχείο fritzing) και τους  αισθητήρες. Αρχίσαμε με τη σύνδεση δύο αισθητήρων για δοκιμή και μετά συνεχίσαμε συνδέοντας τους υπόλοιπους αισθητήρες. Όταν συνδέσαμε όλους τους αισθητήρες, κάνοντας τις απαραίτητες αλλαγές στο πρόγραμμα, τους δοκιμάσαμε και διορθώσαμε τα λάθη μας.



Ο αλγόριθμος που αποφασίζει τη βαθμολογία

Είχαμε σκεφτεί στην αρχή να αποθηκεύουμε τις τιμές των μετρήσεων σε έναν πίνακα και να βγάζουμε τον μέσο όρο. Αυτή η προσέγγιση δεν ήταν εφικτή διότι
1) ο πίνακας θα έπρεπε να είναι πολύ μεγάλος.
2)Ακόμα κι αν μπορούσαμε να είχαμε χιλιάδες τιμές και να βγάζουμε τον μέσο όρο θα ήταν λάθος. Για να το εξηγήσουμε αυτό θα σας παρουσιάσουμε ένα παράδειγμα του αισθητήρα θερμοκρασίας.

Έστω ότι στην πρώτη περίπτωση είχαμε πάρει από μία τάξη τις εξής 10 μετρήσεις:
 17,  23, 17, 23, 17, 23, 17, 23, 17, 23 (oC) = Ο μέσος όρος θα ήταν 20 oC.
Ενώ στη δεύτερη περίπτωση είχαμε πάρει τις εξής 10 μετρήσεις:
 20, 20, 20, 20, 20, 20, 20, 20, 20, 20 (oC) =  Ο μέσος όρος προκύπτει πάλι 20 oC.
Δεν  είναι σωστός λοιπόν ο μέσος όρος γιατί δεν δείχνει το ανεβοκατέβασμα της πρώτης τάξης  και τελικά την δείχνει  ίδια  με τη δεύτερη ενώ δεν είναι.

Για να λύσουμε το παραπάνω πρόβλημα, σε κάθε αισθητήρα έχουμε έναν πίνακα κατανομής (distrib) πέντε θέσεων. Κάθε φορά που παίρνουμε μέτρηση από τον αισθητήρα αυξάνεται κατά ένα, η μία από τις πέντε θέσεις του αντίστοιχου πίνακα κατανομής. Επίσης για κάθε αισθητήρα έχουμε έναν πίνακα, τα στοιχεία του οποίου εκφράζουν τα όρια της κάθε ζώνης (limits). Υπάρχουν τρεις ζώνες: η green, η yellow και η red. Η green εκφράζει τις αποδεκτές μετρήσεις, η yellow τις μεσαίες και η red τις μη αποδεκτές. Η green είναι το μεσαίο στοιχείο του πίνακα (distrib[2]), η yellow είναι τα distrib[1] και distrib[3] ενώ η red τα distrib[0] και distrib[4].
Κάθε φορά που καλείται η συνάρτηση υπολογισμού της ποιότητας της τάξης, βρίσκουμε το ποσοστό των καλών, των μέτριων και των κακών μετρήσεων. Για να το κάνουμε αυτό αρχικά προσθέτουμε τα στοιχεία του πίνακα και αποθηκεύουμε το αποτέλεσμα στην μεταβλητή SUM. Έπειτα διαιρούμε τις καλές μετρήσεις (distrib[2]) με το SUM,διαιρούμε τις μέτριες μετρήσεις (distrib[1]+distrib[3]) με το SUM και τέλος τις κακές μετρήσεις (distrib[0]+distrib[4]) πάλι με το SUM.

Για παράδειγμα παίρνουμε 3% κακές μετρήσεις, 27% μέτριες μετρήσεις και 70% άριστες.  Τώρα έρχεται ένα άλλο πρόβλημα: Πως βαθμολογείται  αυτή η τάξη μας  μετά  από όλες αυτές  τις  μετρήσεις  μαζί;  Κακή, μέτρια ή άριστη;

Πρέπει να αποφασίσουμε εάν το ποσοστό των άριστων μετρήσεων είναι αρκετά υψηλό και το ποσοστό των κακών και των μέτριων μετρήσεων είναι αρκετά χαμηλό. Σκεφτήκαμε το  εξής. Αν πάνω από 5% είναι κακές μετρήσεις τότε το τελικό αποτέλεσμα είναι κακό. Δηλαδή αν σε μία ώρα ο θόρυβος είναι τεράστιος πάνω από τρία λεπτά, τότε όλη η ώρα βαθμολογείται κακή. Για  να βγει μέτρια πρέπει να  είναι 12 λεπτά  μέτρια, αλλιώς (δηλαδή πάνω από 45 λεπτά) βγαίνει άριστη.

Για να το φτιάξουμε σε κώδικα  συγκρίνουμε αρχικά το ποσοστό των κακών μετρήσεων με ένα ποσοστιαίο όριο που θέσαμε εμείς (5%). Έπειτα  συγκρίνουμε  το ποσοστό των μέτριων μετρήσεων με το 20%. Τέλος τις καλές μετρήσεις με το 75%. 

Όλα είναι παραμετρικά  στο πρόγραμμά μας και εύκολα αλλάζουμε  τα  ποσοστά πχ. αλλάζουμε το #define  RED_PCT 0.05 σε #define  RED_PCT 0.10 για να κάνουμε  να ανάβει κόκκινο αν έχουμε πάνω από 10% κακές  μετρήσεις.

Τέλος για  να βαθμολογήσουμε ΟΛΗ την τάξη, έχοντας 5 αισθητήρες κόκκινους,  κίτρινους ή πράσινους ο καθένας διαφορετικός  σκεφτήκαμε διάφορα, απλά  και πολύπλοκα,  και καταλήξαμε τελικά  στο εξής απλό:

Αν  δύο ή παραπάνω  είναι κόκκινοι, τότε όλη η τάξη είναι κόκκινη, αλλιώς
αν τέσσερις ή παραπάνω  είναι πράσινοι  τότε όλη η τάξη είναι πράσινη, αλλιώς
ολη η τάξη είναι κίτρινη. Αυτό είναι εύκολο να το θυμόμαστε, εύκολο να το αλλάξουμε και μοιάζει τελικά σωστότερο από όλα  τα άλλα που σκεφτήκαμε.
